# Security Infrastructure Environment Variables
# Copy this file to .env.local and update with your actual values
# Never commit actual secrets to version control

# Core Encryption Keys (REQUIRED)
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY=your-256-bit-base64-encoded-encryption-key

# Generate with: openssl rand -hex 64
SESSION_SECRET=your-session-secret-for-signing-sessions

# HashiCorp Vault Configuration (Production)
VAULT_ENDPOINT=https://vault.your-domain.com
VAULT_TOKEN=hvs.your-vault-token-for-development-only
VAULT_ROLE_ID=your-role-id-for-production
VAULT_SECRET_ID=your-secret-id-for-production
VAULT_NAMESPACE=admin

# Redis Configuration (Production/Distributed Setup)
REDIS_HOST=redis.your-domain.com
REDIS_PORT=6379
REDIS_PASSWORD=your-redis-password
REDIS_DB=0

# Fallback API Keys (when not using Vault)
# These will be used if Vault is not available or disabled
OPENAI_API_KEY=sk-your-openai-api-key
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key
GOOGLE_API_KEY=your-google-api-key

# Security Configuration Flags
SECURITY_VAULT_ENABLED=false
SECURITY_KEY_ROTATION_ENABLED=false
SECURITY_AUDIT_LEVEL=info
SECURITY_RATE_LIMIT_ENABLED=true

# Development vs Production Settings
# NODE_ENV=development (for local development)
# NODE_ENV=production (for production deployment)

# Webhook URLs for Security Notifications (Optional)
SECURITY_WEBHOOK_URL=https://your-monitoring-service.com/webhook
SECURITY_EMAIL_ALERTS=admin@your-domain.com

# Additional Security Headers (Optional)
SECURITY_CSP_ENABLED=true
SECURITY_HSTS_ENABLED=true
SECURITY_FRAME_OPTIONS=DENY

# Key Rotation Schedule (Cron format)
# Default: Every Sunday at 2 AM UTC
KEY_ROTATION_SCHEDULE=0 2 * * 0

# Session Configuration
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_ROLLING=true

# Rate Limiting Configuration
RATE_LIMIT_REQUESTS=10
RATE_LIMIT_WINDOW=900000

# Audit Log Configuration
AUDIT_LOG_FILE=security-audit.log
AUDIT_LOG_MAX_SIZE=20971520
AUDIT_LOG_MAX_FILES=14

# Zero-Trust Security Configuration
ZERO_TRUST_ENABLED=true
ZERO_TRUST_STRICT_MODE=false
ZERO_TRUST_FINGERPRINTING=true

# API Key Validation Configuration
API_KEY_VALIDATION_ENABLED=true
API_KEY_CACHE_TTL=3600
API_KEY_TEST_TIMEOUT=5000